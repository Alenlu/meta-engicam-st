From bce9412ccefeb24d42ed13d6cde40e6cd909670b Mon Sep 17 00:00:00 2001
From: Matteo Lisi <matteo.lisi@engicam.com>
Date: Thu, 23 May 2019 11:55:38 +0200
Subject: [PATCH] fix ram values

---
 arch/arm/dts/stm32mp15-icore-mx.h             | 30 ++++++------
 arch/arm/dts/stm32mp15-mx.h                   | 48 +++++++++----------
 .../dts/stm32mp157a-icorestm32-mx-u-boot.dtsi |  2 +-
 3 files changed, 40 insertions(+), 40 deletions(-)

diff --git a/arch/arm/dts/stm32mp15-icore-mx.h b/arch/arm/dts/stm32mp15-icore-mx.h
index 50f287f..905ee9b 100644
--- a/arch/arm/dts/stm32mp15-icore-mx.h
+++ b/arch/arm/dts/stm32mp15-icore-mx.h
@@ -10,15 +10,15 @@
  * DDR type: DDR3 / DDR3L
  * DDR width: 32bits
  * DDR density: 4Gb
- * System frequency: 480000Khz
+ * System frequency: 528000Khz
  * Relaxed Timing Mode: false
  * Address mapping type: RBC
  *
- * Save Date: 2019.03.25, save Time: 11:12:22
+ * Save Date: 2019.05.14, save Time: 11:25:16
  */
 
-#define DDR_MEM_NAME	"DDR3-DDR3L 32bits 480000Khz"
-#define DDR_MEM_SPEED	480000
+#define DDR_MEM_NAME	"DDR3-DDR3L 32bits 528000Khz"
+#define DDR_MEM_SPEED	528000
 #define DDR_MEM_SIZE	0x20000000
 
 #define DDR_MSTR 0x00040401
@@ -31,14 +31,14 @@
 #define DDR_HWLPCTL 0x00000000
 #define DDR_RFSHCTL0 0x00210000
 #define DDR_RFSHCTL3 0x00000000
-#define DDR_RFSHTMG 0x0075007D
+#define DDR_RFSHTMG 0x0080008A
 #define DDR_CRCPARCTL0 0x00000000
-#define DDR_DRAMTMG0 0x12182012
-#define DDR_DRAMTMG1 0x000A0419
+#define DDR_DRAMTMG0 0x121B2414
+#define DDR_DRAMTMG1 0x000A041B
 #define DDR_DRAMTMG2 0x0607080F
 #define DDR_DRAMTMG3 0x0050400C
-#define DDR_DRAMTMG4 0x07040507
-#define DDR_DRAMTMG5 0x05050403
+#define DDR_DRAMTMG4 0x07040607
+#define DDR_DRAMTMG5 0x06060403
 #define DDR_DRAMTMG6 0x02020002
 #define DDR_DRAMTMG7 0x00000202
 #define DDR_DRAMTMG8 0x00001005
@@ -85,16 +85,16 @@
 #define DDR_ADDRMAP10 0x00000000
 #define DDR_ADDRMAP11 0x00000000
 #define DDR_PGCR 0x01442E02
-#define DDR_PTR0 0x00226698
-#define DDR_PTR1 0x0413A980
-#define DDR_PTR2 0x042D7700
+#define DDR_PTR0 0x0022A41B
+#define DDR_PTR1 0x047C0740
+#define DDR_PTR2 0x042D9C80
 #define DDR_ACIOCR 0x10400812
 #define DDR_DXCCR 0x00000C40
 #define DDR_DSGCR 0xF200001F
 #define DDR_DCR 0x0000000B
-#define DDR_DTPR0 0x32B277D0
-#define DDR_DTPR1 0x097D00C0
-#define DDR_DTPR2 0x10023200
+#define DDR_DTPR0 0x36D477D0
+#define DDR_DTPR1 0x098A00D8
+#define DDR_DTPR2 0x10023600
 #define DDR_MR0 0x00000830
 #define DDR_MR1 0x00000000
 #define DDR_MR2 0x00000208
diff --git a/arch/arm/dts/stm32mp15-mx.h b/arch/arm/dts/stm32mp15-mx.h
index 905ee9b..86b024b 100644
--- a/arch/arm/dts/stm32mp15-mx.h
+++ b/arch/arm/dts/stm32mp15-mx.h
@@ -8,20 +8,20 @@
 /*
  * File generated by STMicroelectronics STM32CubeMX DDR Tool for MPUs
  * DDR type: DDR3 / DDR3L
- * DDR width: 32bits
- * DDR density: 4Gb
+ * DDR width: 16bits
+ * DDR density: 2Gb
  * System frequency: 528000Khz
  * Relaxed Timing Mode: false
  * Address mapping type: RBC
  *
- * Save Date: 2019.05.14, save Time: 11:25:16
+ * Save Date: 2019.05.16, save Time: 11:12:13
  */
 
-#define DDR_MEM_NAME	"DDR3-DDR3L 32bits 528000Khz"
+#define DDR_MEM_NAME	"DDR3-DDR3L 16bits 528000Khz"
 #define DDR_MEM_SPEED	528000
-#define DDR_MEM_SIZE	0x20000000
+#define DDR_MEM_SIZE	0x10000000
 
-#define DDR_MSTR 0x00040401
+#define DDR_MSTR 0x00041401
 #define DDR_MRCTRL0 0x00000010
 #define DDR_MRCTRL1 0x00000000
 #define DDR_DERATEEN 0x00000000
@@ -34,17 +34,17 @@
 #define DDR_RFSHTMG 0x0080008A
 #define DDR_CRCPARCTL0 0x00000000
 #define DDR_DRAMTMG0 0x121B2414
-#define DDR_DRAMTMG1 0x000A041B
-#define DDR_DRAMTMG2 0x0607080F
+#define DDR_DRAMTMG1 0x000A041C
+#define DDR_DRAMTMG2 0x0608090F
 #define DDR_DRAMTMG3 0x0050400C
-#define DDR_DRAMTMG4 0x07040607
+#define DDR_DRAMTMG4 0x08040608
 #define DDR_DRAMTMG5 0x06060403
 #define DDR_DRAMTMG6 0x02020002
 #define DDR_DRAMTMG7 0x00000202
 #define DDR_DRAMTMG8 0x00001005
 #define DDR_DRAMTMG14 0x000000A0
 #define DDR_ZQCTL0 0xC2000040
-#define DDR_DFITMG0 0x02050105
+#define DDR_DFITMG0 0x02060105
 #define DDR_DFITMG1 0x00000202
 #define DDR_DFILPCFG0 0x07000000
 #define DDR_DFIUPD0 0xC0400003
@@ -75,12 +75,12 @@
 #define DDR_PCFGQOS1_1 0x00800040
 #define DDR_PCFGWQOS0_1 0x01100C03
 #define DDR_PCFGWQOS1_1 0x01000200
-#define DDR_ADDRMAP1 0x00080808
+#define DDR_ADDRMAP1 0x00070707
 #define DDR_ADDRMAP2 0x00000000
-#define DDR_ADDRMAP3 0x00000000
+#define DDR_ADDRMAP3 0x1F000000
 #define DDR_ADDRMAP4 0x00001F1F
-#define DDR_ADDRMAP5 0x07070707
-#define DDR_ADDRMAP6 0x0F0F0707
+#define DDR_ADDRMAP5 0x06060606
+#define DDR_ADDRMAP6 0x0F0F0606
 #define DDR_ADDRMAP9 0x00000000
 #define DDR_ADDRMAP10 0x00000000
 #define DDR_ADDRMAP11 0x00000000
@@ -92,10 +92,10 @@
 #define DDR_DXCCR 0x00000C40
 #define DDR_DSGCR 0xF200001F
 #define DDR_DCR 0x0000000B
-#define DDR_DTPR0 0x36D477D0
+#define DDR_DTPR0 0x38D488D0
 #define DDR_DTPR1 0x098A00D8
 #define DDR_DTPR2 0x10023600
-#define DDR_MR0 0x00000830
+#define DDR_MR0 0x00000840
 #define DDR_MR1 0x00000000
 #define DDR_MR2 0x00000208
 #define DDR_MR3 0x00000000
@@ -109,11 +109,11 @@
 #define DDR_DX1DLLCR 0x40000000
 #define DDR_DX1DQTR 0xFFFFFFFF
 #define DDR_DX1DQSTR 0x3DB02000
-#define DDR_DX2GCR 0x0000CE81
-#define DDR_DX2DLLCR 0x40000000
-#define DDR_DX2DQTR 0xFFFFFFFF
-#define DDR_DX2DQSTR 0x3DB02000
-#define DDR_DX3GCR 0x0000CE81
-#define DDR_DX3DLLCR 0x40000000
-#define DDR_DX3DQTR 0xFFFFFFFF
-#define DDR_DX3DQSTR 0x3DB02000
+#define DDR_DX2GCR 0x00000000
+#define DDR_DX2DLLCR 0x00000000
+#define DDR_DX2DQTR 0x00000000
+#define DDR_DX2DQSTR 0x00000000
+#define DDR_DX3GCR 0x00000000
+#define DDR_DX3DLLCR 0x00000000
+#define DDR_DX3DQTR 0x00000000
+#define DDR_DX3DQSTR 0x00000000
diff --git a/arch/arm/dts/stm32mp157a-icorestm32-mx-u-boot.dtsi b/arch/arm/dts/stm32mp157a-icorestm32-mx-u-boot.dtsi
index 0bbbbbd..4e9b8e7 100644
--- a/arch/arm/dts/stm32mp157a-icorestm32-mx-u-boot.dtsi
+++ b/arch/arm/dts/stm32mp157a-icorestm32-mx-u-boot.dtsi
@@ -5,7 +5,7 @@
  */
 
 #include <dt-bindings/clock/stm32mp1-clksrc.h>
-#include "stm32mp15-mx.h"
+#include "stm32mp15-icore-mx.h"
 
 #include "stm32mp157-u-boot.dtsi"
 #include "stm32mp15-ddr.dtsi"
-- 
2.17.1

